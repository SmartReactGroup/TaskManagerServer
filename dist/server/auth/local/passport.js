"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setup=setup;var _passport=require("passport"),_passport2=_interopRequireDefault(_passport),_passportLocal=require("passport-local");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function localAuthenticate(e,t,s,r){e.findOne({email:t.toLowerCase()}).exec().then(function(e){if(!e)return r(null,!1,{message:"This email is not registered."});e.authenticate(s,function(t,s){return t?r(t):s?r(null,e):r(null,!1,{message:"This password is not correct."})})}).catch(function(e){return r(e)})}function setup(e){_passport2.default.use(new _passportLocal.Strategy({usernameField:"email",passwordField:"password"},function(t,s,r){return localAuthenticate(e,t,s,r)}))}