"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=function(e){var r=e.get("env");"development"!==r&&"test"!==r||e.use(_express2.default.static(_path2.default.join(_environment2.default.root,".tmp"))),"production"===r&&e.use((0,_serveFavicon2.default)(_path2.default.join(_environment2.default.root,"client","favicon.ico"))),e.set("appPath",_path2.default.join(_environment2.default.root,"client")),e.use(_express2.default.static(_path2.default.join(_environment2.default.root,"client","assets"))),e.use(_express2.default.static(e.get("appPath"))),e.use((0,_morgan2.default)("dev")),e.set("views",_environment2.default.root+"/server/views"),e.engine("html",require("ejs").renderFile),e.set("view engine","html"),e.use((0,_compression2.default)()),e.use(_bodyParser2.default.urlencoded({extended:!1})),e.use(_bodyParser2.default.json()),e.use((0,_methodOverride2.default)()),e.use((0,_cookieParser2.default)()),e.use(_passport2.default.initialize()),e.use((0,_expressSession2.default)({secret:_environment2.default.secrets.session,saveUninitialized:!0,resave:!1,store:new MongoStore({mongooseConnection:_mongoose2.default.connection,db:"server"})})),"test"===r||"development"===r||process.env.SAUCE_USERNAME||e.use((0,_lusca2.default)({csrf:!0,xframe:"SAMEORIGIN",hsts:{maxAge:31536e3,includeSubDomains:!0,preload:!0},xssProtection:!0})),"development"!==r&&"test"!==r||e.use((0,_errorhandler2.default)())};var _express=require("express"),_express2=_interopRequireDefault(_express),_serveFavicon=require("serve-favicon"),_serveFavicon2=_interopRequireDefault(_serveFavicon),_morgan=require("morgan"),_morgan2=_interopRequireDefault(_morgan),_compression=require("compression"),_compression2=_interopRequireDefault(_compression),_bodyParser=require("body-parser"),_bodyParser2=_interopRequireDefault(_bodyParser),_methodOverride=require("method-override"),_methodOverride2=_interopRequireDefault(_methodOverride),_cookieParser=require("cookie-parser"),_cookieParser2=_interopRequireDefault(_cookieParser),_errorhandler=require("errorhandler"),_errorhandler2=_interopRequireDefault(_errorhandler),_path=require("path"),_path2=_interopRequireDefault(_path),_lusca=require("lusca"),_lusca2=_interopRequireDefault(_lusca),_environment=require("./environment"),_environment2=_interopRequireDefault(_environment),_passport=require("passport"),_passport2=_interopRequireDefault(_passport),_expressSession=require("express-session"),_expressSession2=_interopRequireDefault(_expressSession),_connectMongo=require("connect-mongo"),_connectMongo2=_interopRequireDefault(_connectMongo),_mongoose=require("mongoose"),_mongoose2=_interopRequireDefault(_mongoose);function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var MongoStore=(0,_connectMongo2.default)(_expressSession2.default);